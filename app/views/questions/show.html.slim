h3= t('.header')

.question
  p#question_title= @question.title
  p#question_body= @question.body

  p#question_files
    =render 'shared/files', resource: @question
  
  p#question_links
    =render 'shared/links', resource: @question

  - if user_signed_in? && current_user.author_of?(question)
    p= link_to t('.delete'), question_path(@question), method: :delete, confirm: 'Delete?'
    p= link_to t('.edit'), '#', data: { question_id: @question.id }, class: 'edit-question-link'

  .question_errors
    = render 'shared/errors', resource: @question

  = render 'form', form_local: false, form_class: 'hidden', submit_text: t('questions.edit.update')

h4= t('.answers')

.answers
  =render question.best_answer, answer_class: 'best_answer' unless question.best_answer_id.nil?
  =render question.other_answers, answer_class: nil

  - if user_signed_in?
    h4= t('.add_answer')
    .answer_errors
      = render 'shared/errors', resource: @answer

    = form_with model: [@question, @answer], local: false, class: 'new-answer' do |f|
      p
        = f.label :body
        = f.text_area :body
      p
        = f.label :files
        = f.file_field :files, multiple: true, direct_upload: true

      p = t('links.new.header')
      #answer_links
        = f.fields_for :links do |link|
        .add_link
          = link_to_add_association t('links.new.add_link'), f, :links, partial: 'links/link_fields'

      p= f.submit t('answers.create.submit')